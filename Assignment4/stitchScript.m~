% stitch script 
left = im2single(rgb2gray(imread('left.jpg')));
right = im2single(rgb2gray(imread('right.jpg')));
n = 18;
p = 4;

[ M, t ] = computeAffineTransformation(left, right, n, p);

M = inv(M);
t = -t;

f1 = imread(?nachtwacht1.jpg?); f2 = imread(?nachtwacht2.jpg?);
T = maketform(?projective?,createProjectionMatrix(xy?, xaya?)?); [x y] = tformfwd(T,[1 size(f1,2)], [1 size(f1,1)]);
xdata = [min(1,x(1)) max(size(f2,2),x(2))];
ydata = [min(1,y(1)) max(size(f2,1),y(2))];
f12 = imtransform(f1,T,?Xdata?,xdata,?YData?,ydata);
f22 = imtransform(f2, maketform(?affine?, [1 0 0; 0 1 0; 0 0 1]),
?Xdata?,xdata,?YData?,ydata); imshow(max(f12,f22));



% subplot(1, 2, 1);
% imshow(left, []);
% title('left');
% 
% subplot(1, 2, 2);
% imshow(right, []);
% title('right');
% 
% figure, imshow(I);